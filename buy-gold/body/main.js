document.addEventListener("DOMContentLoaded",()=>{setTimeout(()=>{console.log("Checkbox styling disabled - filter manager handles styling")},100)}),function(){"use strict";const e={elementId:"custom-filter",defaultText:"Sort...",defaultValue:"default",retryDelay:300,options:[{text:"Default (Popular)",value:"default"},{text:'\n    <svg width="16" height="16" viewBox="0 0 801 801" fill="none" xmlns="http://www.w3.org/2000/svg" style="vertical-align: middle; margin-right: 2px; position: relative; top: -2px;">\n      <path d="M400 0.597656L533.325 300.598L800.022 333.934L599.987 500.599L666.65 800.604L400 633.924L133.331 800.604L199.999 500.599L-0.00292969 333.934L266.666 300.598L400 0.597656Z" fill="#F39C12"/>\n      <path d="M400 1V434.333L533.333 301L400 1Z" fill="#F1C40F"/>\n      <path d="M400 434.332L800 334.332L600 500.999L400 434.332Z" fill="#F1C40F"/>\n      <path d="M400 434.332L666.667 800.999L400 634.332V434.332Z" fill="#F1C40F"/>\n      <path d="M400 434.332L133.333 800.999L200 500.999L400 434.332Z" fill="#F1C40F"/>\n      <path d="M400 434.333L0 334.333L266.667 301L400 434.333Z" fill="#F1C40F"/>\n    </svg>\n  Same Day Collect',value:"in-stock-select"},{text:"Latest / 2025",value:"latest"},{text:"Price: Best per Oz",value:"value"},{text:"Price: Low to High",value:"lowest-price"},{text:"Weight: Low to High",value:"lowest-weight"},{text:"Weight: High to Low",value:"highest-weight"},{text:"All Gold",value:"all-gold-select"},{text:"All Silver",value:"all-silver-select"}]},t={default:{type:"sort",operation:"default"},"getting-started-select":{type:"filter",operation:"checkbox_starter"},"popular-select":{type:"filter",operation:"checkbox_popular"},"investor-select":{type:"filter",operation:"checkbox_investor"},"all-gold-select":{type:"filter",operation:"checkbox_gold"},"all-silver-select":{type:"filter",operation:"checkbox_silver"},"in-stock-select":{type:"filter",operation:"checkbox_in_stock"},latest:{type:"sort",operation:"latest"},value:{type:"sort",operation:"value"},"lowest-price":{type:"sort",operation:"lowest-price"},"lowest-weight":{type:"sort",operation:"lowest-weight"},"highest-weight":{type:"sort",operation:"highest-weight"}};class i{constructor(e){this.config=e,this.element=null,this.selectedElement=null,this.optionsElement=null,this.selectedText=null,this.caret=null,this.isOpen=!1,this.init()}init(){if(this.element=document.getElementById(this.config.elementId),!this.element)return console.log(`Waiting for '${this.config.elementId}' element to be available...`),void setTimeout(()=>this.init(),this.config.retryDelay);this.buildDropdown(),this.bindEvents(),console.log("Custom dropdown initialized successfully")}buildDropdown(){this.element.innerHTML="",this.element.className="custom-dropdown",this.selectedElement=this.createElement("div","filter-selected"),this.selectedText=this.createElement("span","selected-text",this.config.defaultText),this.caret=this.createElement("span","dropdown-caret"),this.selectedElement.appendChild(this.selectedText),this.selectedElement.appendChild(this.caret),this.optionsElement=this.createElement("div","filter-options"),this.buildOptions(),this.element.appendChild(this.selectedElement),this.element.appendChild(this.optionsElement),this.element.setAttribute("data-selected",this.config.defaultValue)}createElement(e,t,i=""){const s=document.createElement(e);return s.className=t,i&&(s.textContent=i),s}buildOptions(){this.config.options.forEach(e=>{const t=this.createElement("div","filter-option");t.innerHTML=e.text,t.setAttribute("data-value",e.value),this.optionsElement.appendChild(t)})}bindEvents(){this.selectedElement.addEventListener("click",e=>this.toggleDropdown(e)),this.optionsElement.addEventListener("click",e=>this.handleOptionClick(e)),document.addEventListener("click",e=>this.handleOutsideClick(e)),this.element.addEventListener("keydown",e=>this.handleKeyboard(e))}toggleDropdown(e){e.stopPropagation(),this.isOpen=!this.isOpen,this.element.classList.toggle("active",this.isOpen),this.optionsElement.style.display=this.isOpen?"block":"none"}closeDropdown(){this.isOpen=!1,this.element.classList.remove("active"),this.optionsElement.style.display="none"}handleOptionClick(e){const t=e.target.closest(".filter-option");if(!t)return;const i=t.getAttribute("data-value"),s=t.textContent.trim();this.selectOption(i,s)}selectOption(e,t){this.selectedText.textContent=t,this.selectedElement.setAttribute("data-value",e),this.element.setAttribute("data-selected",e),this.closeDropdown(),this.dispatchOperationEvent(e,t),console.log(`Dropdown selection: ${e} (${t})`)}dispatchOperationEvent(e,i){const s=t[e];if(!s)return void console.warn(`No operation mapping found for: ${e}`);const o="filter"===s.type?"filterOperation":"sortOperation",r=window.innerWidth<=1023,n=new CustomEvent(o,{detail:{operation:s.operation,originalValue:e,text:i,resetFirst:r},bubbles:!0});this.element.dispatchEvent(n),console.log(`Dispatched ${o} for: ${s.operation}`)}handleOutsideClick(e){!this.element.contains(e.target)&&this.isOpen&&this.closeDropdown()}handleKeyboard(e){if(this.isOpen&&"Escape"===e.key)this.closeDropdown()}reset(){this.selectOption(this.config.defaultValue,this.config.defaultText)}}function s(){window.customDropdown=new i(e)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",s):s()}(),document.addEventListener("DOMContentLoaded",function(){"use strict";new class{constructor(e){this.config=e,this.buttons={},this.filterStates={},this.productElements=[],this.gridContainer=null,this.originalOrder=[],this.needsOrderRestoration=!1,this.scrollTriggerFilters=["checkbox_coin","checkbox_minted_bar","checkbox_cast_bar","checkbox_1g","checkbox_2_5g","checkbox_5g","checkbox_10g","checkbox_20g","checkbox_25g","checkbox_1_20oz","checkbox_1_10oz","checkbox_1_4oz","checkbox_1_2oz","checkbox_1oz","checkbox_2oz","checkbox_5oz","checkbox_10oz","checkbox_1kg","checkbox_asahi","checkbox_austrian","checkbox_gsm","checkbox_investment","checkbox_nzmint","checkbox_pamp","checkbox_canada","checkbox_african","checkbox_highland","checkbox_perth","checkbox_royal","checkbox_usa","checkbox_valcambi"],this.specialDivs={speakToDealer:null,personalDealerEndBlock:null,gettingStartedBlock:null,investmentBlock:null},this.originalDivStates={},this.init()}init(){this.cacheElements(),this.initializeStates(),this.bindDesktopEvents(),this.bindMobileEvents(),this.cacheProducts(),this.setupGlobalNamespace(),console.log("ðŸš€ PERFORMANCE OPTIMIZED Filter Manager initialized")}cacheElements(){Object.entries(this.config.buttons).forEach(([e,t])=>{this.buttons[e]=document.getElementById(t)}),this.clearButton=document.getElementById(this.config.clearButton),this.clearButtonMobile=document.getElementById("clear-filter-mobile"),this.makeItEasyButton=document.getElementById("make-it-easy"),this.specialDivs.speakToDealer=document.getElementById("speak-to-dealer"),this.specialDivs.personalDealerEndBlock=document.getElementById("personal-dealer-end-block"),this.specialDivs.gettingStartedBlock=document.getElementById("getting-started-block"),this.specialDivs.investmentBlock=document.getElementById("investment-block"),Object.entries(this.specialDivs).forEach(([e,t])=>{t&&(this.originalDivStates[e]=window.getComputedStyle(t).display)})}initializeStates(){Object.keys(this.config.rules).forEach(e=>{this.filterStates[e]=!1})}cacheProducts(){this.productElements=Array.from(document.querySelectorAll(".product-data")),this.gridContainer=document.querySelector(".w-dyn-items.w-row"),this.captureOriginalOrder(),console.log(`ðŸš€ PERFORMANCE: Cached ${this.productElements.length} product elements`)}bindDesktopEvents(){Object.entries(this.buttons).forEach(([e,t])=>{t&&this.config.rules[e]&&(t.style.cursor="pointer",t.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation(),this.toggleFilter(e)}))}),this.clearButton&&(this.clearButton.style.cursor="pointer",this.clearButton.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),this.clearAllFilters()})),this.clearButtonMobile&&(this.clearButtonMobile.style.cursor="pointer",this.clearButtonMobile.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),this.clearAllFilters()})),this.makeItEasyButton&&(this.makeItEasyButton.style.cursor="pointer",this.makeItEasyButton.addEventListener("click",e=>{if(e.preventDefault(),e.stopPropagation(),this.toggleFilter("checkbox_starter"),window.innerWidth<=991){const e=document.getElementById("getting-started-block");if(e){const t=e.offsetTop-96;window.scrollTo({top:t,behavior:"smooth"}),console.log("ðŸš€ MOBILE/TABLET: Scrolled to getting-started-block with navbar offset")}}}))}bindMobileEvents(){const e=document.getElementById("custom-filter");e?e.addEventListener("filterOperation",e=>{const{operation:t,resetFirst:i}=e.detail;i&&this.resetFiltersOnly(),this.config.rules[t]&&this.applyFilter(t,!0)}):setTimeout(()=>this.bindMobileEvents(),300)}toggleFilter(e){const t=!this.filterStates[e],i=Object.keys(this.config.exclusiveGroups).find(t=>this.config.exclusiveGroups[t].includes(e));t&&i&&this.config.exclusiveGroups[i].forEach(t=>{t!==e&&this.filterStates[t]&&(this.filterStates[t]=!1,this.updateButtonStyles(t,!1))}),this.applyFilter(e,t),i&&this.updateGroupStyles(i,t?e:null)}applyFilter(e,t){this.filterStates[e]=t,this.updateButtonStyles(e,t),t&&this.scrollTriggerFilters.includes(e)&&this.scrollToPriceTicker(),(e.includes("checkbox_starter")||e.includes("checkbox_popular")||e.includes("checkbox_in_stock"))&&(!this._lastFilterChangeTime||Date.now()-this._lastFilterChangeTime>500)&&(console.log(`ðŸš€ FILTER: ${e.replace("checkbox_","")} ${t?"ON":"OFF"}`),this._lastFilterChangeTime=Date.now()),this.applyAllFiltersOptimized()}scrollToPriceTicker(){const e=document.getElementById("price-ticker");if(!e)return;const t=e.getBoundingClientRect().top+window.pageYOffset,i=window.pageYOffset,s=t-i;let o=null;const r=e=>{null===o&&(o=e);const t=e-o,n=(l=t,a=i,c=s,(l/=800/2)<1?c/2*l*l+a:-c/2*(--l*(l-2)-1)+a);var l,a,c;window.scrollTo(0,n),t<800&&requestAnimationFrame(r)};requestAnimationFrame(r),console.log("ðŸš€ SCROLL: Initiated custom smooth scroll to price-ticker")}applyAllFiltersOptimized(){if(!this.gridContainer)return;window.searchManager&&window.searchManager.clearNoResultsMessage&&window.searchManager.clearNoResultsMessage();let e=0;const t=new Set,i=Object.entries(this.filterStates).filter(([e,t])=>t),s=window.searchManager&&window.searchManager.isActive&&window.searchManager.isActive();if(0===i.length&&!s)return this.showAllItemsCSS(),this.restoreOriginalOrder(),void this.manageDivVisibility();if(!(this.filterStates.checkbox_popular||this.filterStates.checkbox_starter)&&this.needsOrderRestoration&&(this.restoreOriginalOrder(),this.needsOrderRestoration=!1),s){const e=window.searchManager.getCurrentTerm();if(e)return setTimeout(()=>{if(window.searchManager.filterProductsWithCSS){const t=window.searchManager.filterProductsWithCSS(e);console.log(`ðŸš€ COORDINATION: Search + Filter working together - ${t} products visible`)}},10),void this.manageDivVisibility()}this.productElements.forEach(i=>{const s=i.getAttribute("data-slug");if(t.has(s))return;const o=i.closest(".w-dyn-item");if(!o)return;const r=this.shouldShowAnyDataElementForSlug(s);o.classList.toggle("filter-hidden",!r),r&&e++,t.add(s)}),this.filterStates.checkbox_popular&&(this.applyPopularSortCSS(),this.needsOrderRestoration=!0),this.filterStates.checkbox_starter&&(this.applyStarterSortCSS(),this.needsOrderRestoration=!0),this.manageDivVisibility(),(!this._lastFilterLogTime||Date.now()-this._lastFilterLogTime>1e3)&&(console.log(`ðŸš€ PERFORMANCE: Filter-only processing - ${e} products visible`),this._lastFilterLogTime=Date.now())}showAllItemsCSS(){this.productElements.forEach(e=>{const t=e.closest(".w-dyn-item");t&&t.classList.remove("filter-hidden")})}applyPopularSortCSS(){if(!this.filterStates.checkbox_popular||!this.gridContainer)return;const e=Array.from(this.gridContainer.querySelectorAll(".w-dyn-item:not(.filter-hidden)")),t=[];e.forEach(e=>{const i=e.querySelector(".product-data");if(!i)return;const s=i.getAttribute("data-popular");s&&!isNaN(parseInt(s))&&t.push({element:e,value:parseInt(s)})}),t.sort((e,t)=>e.value-t.value);const i=document.createDocumentFragment();t.forEach(e=>{i.appendChild(e.element)}),this.gridContainer.appendChild(i),(!this._lastPopularSortTime||Date.now()-this._lastPopularSortTime>2e3)&&(console.log(`ðŸš€ SORT: ${t.length} items by popularity`),this._lastPopularSortTime=Date.now())}applyStarterSortCSS(){if(!this.filterStates.checkbox_starter||!this.gridContainer)return;const e=Array.from(this.gridContainer.querySelectorAll(".w-dyn-item:not(.filter-hidden)")),t=[];e.forEach(e=>{const i=e.querySelector(".product-data");if(!i)return;const s=i.getAttribute("data-getting-started");s&&!isNaN(parseInt(s))&&t.push({element:e,value:parseInt(s)})}),t.sort((e,t)=>e.value-t.value);const i=document.createDocumentFragment();t.forEach(e=>{i.appendChild(e.element)}),this.gridContainer.appendChild(i),(!this._lastStarterSortTime||Date.now()-this._lastStarterSortTime>2e3)&&(console.log(`ðŸš€ SORT: ${t.length} items by starter order`),this._lastStarterSortTime=Date.now())}manageDivVisibility(){this.filterStates.checkbox_dealer?(this.specialDivs.speakToDealer&&(this.specialDivs.speakToDealer.style.display="block"),this.specialDivs.personalDealerEndBlock&&(this.specialDivs.personalDealerEndBlock.style.display="none"),this.specialDivs.gettingStartedBlock&&(this.specialDivs.gettingStartedBlock.style.display="none")):(this.specialDivs.speakToDealer&&this.originalDivStates.speakToDealer&&(this.specialDivs.speakToDealer.style.display=this.originalDivStates.speakToDealer),this.specialDivs.personalDealerEndBlock&&this.originalDivStates.personalDealerEndBlock&&(this.specialDivs.personalDealerEndBlock.style.display=this.originalDivStates.personalDealerEndBlock),this.filterStates.checkbox_starter?this.specialDivs.gettingStartedBlock&&(this.specialDivs.gettingStartedBlock.style.display="block"):this.specialDivs.gettingStartedBlock&&(this.specialDivs.gettingStartedBlock.style.display="none"),this.filterStates.checkbox_investor?this.specialDivs.investmentBlock&&(this.specialDivs.investmentBlock.style.display="block"):this.specialDivs.investmentBlock&&(this.specialDivs.investmentBlock.style.display="none"))}shouldShowAnyDataElementForSlug(e){return this.productElements.filter(t=>t.getAttribute("data-slug")===e).some(e=>this.shouldShowProduct(e))}shouldShowProduct(e){const t=Object.entries(this.filterStates).filter(([e,t])=>t);if(0===t.length)return!0;if(this.filterStates.checkbox_dealer)return!1;for(const[i,s]of t){if(!s)continue;if("checkbox_popular"===i){const t=e.getAttribute("data-popular");if(!t||isNaN(parseInt(t)))return!1;continue}if("checkbox_starter"===i){const t=e.getAttribute("data-getting-started");if(!t||isNaN(parseInt(t)))return!1;continue}if("checkbox_in_stock"===i){if("in-stock"!==e.getAttribute("data-stock-status"))return!1;continue}if("checkbox_live_mint"===i){if("live-at-the-mint"!==e.getAttribute("data-stock-status"))return!1;continue}const t=this.config.rules[i];if(!t)continue;const o=e.getAttribute(t.attribute);if(!o)return!1;if(!t.values.includes(o))return!1}return!0}updateButtonStyles(e,t){this.updateCheckboxStyles(e,t),"checkbox_starter"===e&&this.makeItEasyButton&&this.updateMakeItEasyButton(t),"checkbox_starter"===e&&this.updateStarterSVGIcons(t)}updateCheckboxStyles(e,t){const i=this.buttons[e];if(!i)return;const s=i.querySelector(".custom-checkmark");if(s&&s.remove(),t){const e=document.createElement("div");e.className="custom-checkmark",e.innerHTML='\n          <svg width="20" height="20" viewBox="0 0 24 24" style="position: absolute; top: -5px; left: -2px; pointer-events: none;">\n            <polyline fill="none" points="3.7 14.3 9.6 19 20.3 5" stroke="#666" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/>\n          </svg>\n        ',e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.pointerEvents="none",i.style.position="relative",i.appendChild(e)}i.style.backgroundColor=""}updateMakeItEasyButton(e){this.makeItEasyButton&&(e?(this.makeItEasyButton.classList.add("active"),console.log("ðŸš€ MAKE IT EASY: Button activated - colors inverted")):(this.makeItEasyButton.classList.remove("active"),console.log("ðŸš€ MAKE IT EASY: Button deactivated - colors restored")))}updateStarterSVGIcons(e){const t=document.getElementById("svg-start-icon-buy-page-loading"),i=document.getElementById("svg-start-icon-buy-page-play");if(!t&&!i)return this.createStarterSVGIcons(),this.updateStarterSVGIcons(e);e?(t&&(t.style.display="none"),i&&(i.style.display="block"),console.log("ðŸš€ STARTER SVG: Switched to play icon (checkbox active)")):(t&&(t.style.display="block"),i&&(i.style.display="none"),console.log("ðŸš€ STARTER SVG: Switched to loading icon (checkbox inactive)"))}createStarterSVGIcons(){const e=this.buttons.checkbox_starter;if(!e)return void console.warn("ðŸš€ STARTER SVG: Getting started checkbox not found");let t=e.parentElement;if(!t)return void console.warn("ðŸš€ STARTER SVG: No suitable container found for SVG icons");const i=document.createElement("div");i.id="svg-start-icon-buy-page-loading",i.innerHTML='\n        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <circle cx="12" cy="12" r="10" stroke="#ccc" stroke-width="2"/>\n          <path d="M12 2a10 10 0 0 1 10 10" stroke="#666" stroke-width="2" stroke-linecap="round">\n            <animateTransform attributeName="transform" attributeType="XML" type="rotate" \n                            from="0 12 12" to="360 12 12" dur="1s" repeatCount="indefinite"/>\n          </path>\n        </svg>\n      ',i.style.display="block",i.style.marginLeft="8px";const s=document.createElement("div");s.id="svg-start-icon-buy-page-play",s.innerHTML='\n        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <circle cx="12" cy="12" r="10" fill="#28a745" stroke="#28a745" stroke-width="2"/>\n          <polygon points="10,8 16,12 10,16" fill="white"/>\n        </svg>\n      ',s.style.display="none",s.style.marginLeft="8px",t.appendChild(i),t.appendChild(s),console.log("ðŸš€ STARTER SVG: Created SVG icons dynamically")}resetAllFilters(){Object.keys(this.filterStates).forEach(e=>{this.filterStates[e]=!1,this.updateButtonStyles(e,!1)}),Object.entries(this.specialDivs).forEach(([e,t])=>{t&&this.originalDivStates[e]&&(t.style.display=this.originalDivStates[e])}),this.showAllItemsCSS(),this.needsOrderRestoration=!1;const e=document.getElementById("search-product-list");if(e&&e.value.trim().length>0){const t=e.value.trim();this.performSearchOptimized(t),console.log(`ðŸš€ PERFORMANCE: Filters reset but search reapplied: "${t}"`)}else this.restoreOriginalOrder(),console.log("ðŸš€ PERFORMANCE: All filters reset")}clearAllFilters(){window.searchManager&&window.searchManager.clearSearch&&window.searchManager.clearSearch(),Object.keys(this.config.exclusiveGroups).forEach(e=>{this.updateGroupStyles(e,null)}),Object.keys(this.filterStates).forEach(e=>{this.filterStates[e]=!1,this.updateButtonStyles(e,!1)}),Object.entries(this.specialDivs).forEach(([e,t])=>{t&&this.originalDivStates[e]&&(t.style.display=this.originalDivStates[e])}),this.showAllItemsCSS(),this.restoreOriginalOrder(),this.needsOrderRestoration=!1,window.customDropdown&&window.customDropdown.reset&&window.customDropdown.reset(),console.log("ðŸš€ PERFORMANCE: All filters and search cleared")}updateGroupStyles(e,t){const i=this.config.exclusiveGroups[e];i&&i.forEach(e=>{const i=document.querySelector(`[data-filter-parent-for="${e}"]`);i&&(t?e===t?(i.classList.add("filter-selected"),i.classList.remove("filter-disabled")):(i.classList.add("filter-disabled"),i.classList.remove("filter-selected")):(i.classList.remove("filter-selected"),i.classList.remove("filter-disabled")))})}resetFiltersOnly(){Object.keys(this.filterStates).forEach(e=>{this.filterStates[e]=!1,this.updateButtonStyles(e,!1)}),Object.entries(this.specialDivs).forEach(([e,t])=>{t&&this.originalDivStates[e]&&(t.style.display=this.originalDivStates[e])}),this.showAllItemsCSS(),this.needsOrderRestoration=!1,console.log("ðŸš€ PERFORMANCE: Filters reset (search input preserved)")}performSearchOptimized(e){if(!e)return void this.showAllItemsCSS();e.toLowerCase();const t=new Set;let i=0;this.productElements.forEach(s=>{const o=s.getAttribute("data-slug");if(t.has(o))return;const r=this.doesProductMatchSearch(s,e),n=s.closest(".w-dyn-item");n&&(n.classList.toggle("filter-hidden",!r),r&&i++),t.add(o)}),0===i&&this.showNoResultsMessage(),console.log(`ðŸš€ PERFORMANCE: Search complete - ${i} products found`)}doesProductMatchSearch(e,t){if(!t)return!0;const i=t.toLowerCase(),s=["data-name2","data-mint","data-metal","data-size","data-year","data-product-id"];for(const t of s){const s=e.getAttribute(t);if(s&&s.toLowerCase().includes(i))return!0}return!1}showNoResultsMessage(){if(!this.gridContainer)return;const e=document.createElement("div");e.style.width="100%",e.style.textAlign="center",e.style.padding="40px 20px",e.style.color="#666",e.style.fontSize="18px",e.innerHTML="No products found matching your search.",e.className="no-results-message",this.gridContainer.appendChild(e)}captureOriginalOrder(){if(!this.gridContainer)return;this.gridContainer.querySelectorAll(".w-dyn-item").forEach(e=>{const t=e.querySelector(".product-data");if(t){const e=t.getAttribute("data-slug");e&&!this.originalOrder.includes(e)&&this.originalOrder.push(e)}}),console.log(`ðŸš€ PERFORMANCE: Captured original order for ${this.originalOrder.length} products`)}restoreOriginalOrder(){if(!this.gridContainer||0===this.originalOrder.length)return;const e=document.createDocumentFragment();this.originalOrder.forEach(t=>{const i=this.gridContainer.querySelector(`[data-slug="${t}"]`);if(i){const t=i.closest(".w-dyn-item");t&&e.appendChild(t)}}),this.gridContainer.appendChild(e),(!this._lastLogTime||Date.now()-this._lastLogTime>2e3)&&(console.log(`ðŸš€ PERFORMANCE: Restored ${this.originalOrder.length} items to original order`),this._lastLogTime=Date.now())}setupGlobalNamespace(){window.filterControls=window.filterControls||{},window.filterControls.resetAllFilters=()=>this.resetAllFilters(),window.filterControls.resetFiltersOnly=()=>this.resetFiltersOnly(),window.filterControls.getActiveFilters=()=>Object.entries(this.filterStates).filter(([e,t])=>t).map(([e,t])=>e),window.filterControls.checkProductPassesFilters=e=>{const t=e.getAttribute("data-slug");return this.shouldShowAnyDataElementForSlug(t)},window.filterControls.hasActiveFilters=()=>Object.values(this.filterStates).some(e=>e)}}(window.FILTER_CONFIG)}),document.addEventListener("DOMContentLoaded",function(){const e=document.querySelector("#price-ticker.price-ticker-buy");if(!e)return;const t=e.querySelectorAll(".our-prices-ticker");if(!t.length)return;if(e.querySelector(".price-ticker-wrapper"))return;const i=document.createElement("a");i.href="/live-prices/gold-price-nz",i.className="price-ticker-link";const s=document.createElement("div");s.className="price-ticker-wrapper",t.forEach(e=>{s.appendChild(e.cloneNode(!0))});const o=s.cloneNode(!0);o.className+=" price-ticker-clone",i.appendChild(s),i.appendChild(o),e.innerHTML="",e.appendChild(i),e.classList.add("price-ticker-running");new IntersectionObserver(t=>{e.classList.toggle("price-ticker-running",t[0].isIntersecting)},{threshold:.1}).observe(e)}),document.addEventListener("DOMContentLoaded",function(){console.log("Fast promo visibility script loaded");let e=null,t=null,i=null,s=new Map;const o=document.getElementById("test-button");function r(){if(window.filterControls&&window.filterControls.getActiveFilters){const t=window.filterControls.getActiveFilters().includes("checkbox_starter");e!==t&&(console.log("Starter filter is now "+(t?"ACTIVE":"INACTIVE")),e=t,t?n():l())}}function n(){s.size>0?s.forEach((e,t)=>{e.isStarter&&c(e.promoDiv)}):(i||(i=document.querySelectorAll(".product-data[data-getting-started]")),0!==i.length?i.forEach(e=>{const t=a(e);if(!t)return;const i=t.querySelector('[id="getting-started-promo"]');i&&c(i)}):console.log("No starter products found"))}function l(){s.size>0?s.forEach(e=>{e.promoDiv.style.display="none"}):(t||(t=document.querySelectorAll('[id="getting-started-promo"]')),t.forEach(e=>{e.style.display="none"}))}function a(e){let t=e.parentElement,i=0;for(;t&&i<10;){if(t.classList.contains("w-dyn-item"))return t;t=t.parentElement,i++}return null}function c(e){e.style.cssText="\n      display: block !important;\n      visibility: visible !important;\n      opacity: 1 !important;\n      height: auto !important;\n      overflow: visible !important;\n      position: relative !important;\n      width: 100% !important;\n      margin: 15px 0 !important;\n      padding: 20px !important;\n      background: #f8f9fa !important;\n      border: 1px solid #e0e0e0 !important;\n      border-radius: 8px !important;\n      z-index: 1 !important;\n    "}o&&(o.addEventListener("click",function(){console.log("Test button clicked - forcing all starter promos visible"),n()}),console.log("Test button found and handler attached")),t=document.querySelectorAll('[id="getting-started-promo"]'),i=document.querySelectorAll(".product-data[data-getting-started]"),t.forEach(e=>{const t=a(e);if(t){const i=t.querySelector(".product-data");if(i){const o=i.getAttribute("data-product-id");o&&s.set(o,{promoDiv:e,productData:i,container:t,isStarter:i.hasAttribute("data-getting-started")&&""!==i.getAttribute("data-getting-started").trim()})}}}),console.log(`Cached ${t.length} promo divs and ${i.length} starter products`),function(){const e=document.getElementById("checkbox_starter");e&&(e.addEventListener("change",function(){const e=this.checked;console.log(`Starter checkbox directly changed to: ${e}`),e?n():l()}),console.log("Added direct listener to checkbox_starter")),setInterval(r,1e3),function(){const e=new MutationObserver(function(e){this.mutationTimeout&&clearTimeout(this.mutationTimeout),this.mutationTimeout=setTimeout(()=>{let t=!1;e.forEach(function(e){"attributes"===e.type&&"class"===e.attributeName&&e.target.classList.contains("w-dyn-item")&&(t=!0)}),t&&r()},200)}),t=document.querySelectorAll(".w-dyn-item");t.forEach(t=>{e.observe(t,{attributes:!0})}),console.log(`Set up mutation observer for ${t.length} product containers`)}()}(),r(),setTimeout(r,100)}),document.addEventListener("DOMContentLoaded",function(){"use strict";new class{constructor(e){this.config=e,this.searchInput=null,this.searchIcon=null,this.searchTimeout=null,this.isSearchActive=!1,this.originalProducts=[],this.gridContainer=null,this.hasMovedToTop=!1,this.scrollReleased=!1,this.isPositioning=!1,this.keyboardVisible=!1,this.userScrolledWhileKeyboardUp=!1,this.keyboardHeight=0,this.init()}init(){this.cacheElements(),this.cacheOriginalProducts(),this.bindEvents(),this.setupVirtualKeyboard(),this.setupScrollRelease(),this.setupGlobalAccess(),console.log("ðŸš€ PERFORMANCE OPTIMIZED Search Manager initialized")}cacheElements(){this.searchInput=document.getElementById(this.config.inputId),this.searchIcon=document.getElementById(this.config.iconId),this.gridContainer=document.querySelector(".w-dyn-items.w-row"),this.searchInput||console.error(`Search input with ID '${this.config.inputId}' not found`),this.searchIcon||console.error(`Search icon with ID '${this.config.iconId}' not found`)}cacheOriginalProducts(){this.originalProducts=Array.from(document.querySelectorAll(".product-data")),console.log(`ðŸš€ PERFORMANCE: Cached ${this.originalProducts.length} products for search`)}bindEvents(){this.searchInput&&(this.searchInput.addEventListener("input",e=>{this.handleSearchInput(e.target.value)}),this.searchInput.addEventListener("keydown",e=>{"Escape"===e.key&&this.clearSearch(),"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),this.searchInput.blur(),console.log("Enter key pressed - form submission prevented"))})),this.searchIcon&&(this.searchIcon.style.cursor="pointer",this.searchIcon.addEventListener("click",()=>{this.handleIconClick()}))}handleSearchInput(e){this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.performSearchOptimized(e.trim())},this.config.debounceDelay)}handleIconClick(){if(this.searchInput){const e=this.searchInput.value.trim();this.performSearchOptimized(e),this.searchInput.blur()}}setupVirtualKeyboard(){if("virtualKeyboard"in navigator)try{navigator.virtualKeyboard.overlaysContent=!0,console.log("ðŸš€ MOBILE: VirtualKeyboard API enabled - search input position locked"),navigator.virtualKeyboard.addEventListener("geometrychange",()=>{const e=navigator.virtualKeyboard.boundingRect.height;this.keyboardHeight=e,e>0?(this.keyboardVisible=!0,this.userScrolledWhileKeyboardUp=!1,this.userScrolledWhileKeyboardUp?console.log("ðŸš€ MOBILE: Keyboard appeared but user scrolled - skipping positioning"):(this.moveInputToTop(),console.log("ðŸš€ MOBILE: Keyboard appeared - moving input to top"))):(this.keyboardVisible=!1,this.userScrolledWhileKeyboardUp=!1,console.log("ðŸš€ MOBILE: Keyboard disappeared"))})}catch(e){console.log("VirtualKeyboard API failed to initialize:",e)}else console.log("VirtualKeyboard API not supported - using browser default behavior")}moveInputToTop(){!this.searchInput||this.isPositioning||this.userScrolledWhileKeyboardUp?this.userScrolledWhileKeyboardUp&&console.log("ðŸš€ MOBILE: Skipping moveInputToTop - user has scrolled"):(this.isPositioning=!0,setTimeout(()=>{if(this.userScrolledWhileKeyboardUp)return this.isPositioning=!1,void console.log("ðŸš€ MOBILE: Aborting moveInputToTop - user scrolled during delay");const e=.12*window.innerHeight,t=this.searchInput.getBoundingClientRect(),i=window.pageYOffset+t.top-e;window.scrollTo({top:i,behavior:"smooth"}),setTimeout(()=>{this.hasMovedToTop=!0,this.scrollReleased=!1,this.isPositioning=!1,console.log("ðŸš€ MOBILE: Search input positioned at 12% from top")},500)},100))}setupScrollRelease(){let e=window.pageYOffset;window.addEventListener("scroll",()=>{const t=window.pageYOffset,i=Math.abs(t-e);this.keyboardVisible&&i>10&&(this.userScrolledWhileKeyboardUp||(this.userScrolledWhileKeyboardUp=!0,console.log("ðŸš€ MOBILE: User scroll detected while keyboard up - disabling auto-positioning")),this.isPositioning&&(this.isPositioning=!1,console.log("ðŸš€ MOBILE: Aborting active positioning due to user scroll"))),!this.hasMovedToTop||this.scrollReleased||this.isPositioning||i>25&&this.releasePositioning(),e=t},{passive:!0});window.addEventListener("touchstart",()=>{this.keyboardVisible&&console.log("ðŸš€ MOBILE: Touch started while keyboard visible")},{passive:!0}),window.addEventListener("touchmove",e=>{this.keyboardVisible&&!this.userScrolledWhileKeyboardUp&&(this.userScrolledWhileKeyboardUp=!0,console.log("ðŸš€ MOBILE: Touch scroll detected while keyboard up - disabling auto-positioning"),this.isPositioning&&(this.isPositioning=!1,console.log("ðŸš€ MOBILE: Aborting positioning due to touch scroll")))},{passive:!0}),console.log("ðŸš€ MOBILE: Enhanced keyboard-aware scroll release functionality initialized")}releasePositioning(){this.scrollReleased||(this.scrollReleased=!0,console.log("ðŸš€ MOBILE: Positioning released - user can now scroll freely"),this.searchInput&&(this.searchInput.classList.add("positioning-released"),setTimeout(()=>{this.searchInput.classList.remove("positioning-released")},2e3)))}performSearchOptimized(e){if((!this._lastSearchLogTime||Date.now()-this._lastSearchLogTime>1e3)&&(console.log(`ðŸš€ SEARCH: "${e}"`),this._lastSearchLogTime=Date.now()),!e)return void this.clearSearch();this.isSearchActive=!0;const t=this.filterProductsWithCSS(e);0===t&&this.showNoResultsMessage(),(0===t||t>=5)&&console.log(`ðŸš€ SEARCH: ${t} products found for "${e}"`)}filterProductsWithCSS(e){const t=e.toLowerCase(),i=new Set;let s=0;return this.originalProducts.forEach(e=>{const o=e.getAttribute("data-slug");if(i.has(o))return;const r=this.doesProductMatch(e,t);let n=!0;window.filterControls&&window.filterControls.checkProductPassesFilters&&(n=window.filterControls.checkProductPassesFilters(e));const l=r&&n,a=e.closest(".w-dyn-item");a&&(a.classList.toggle("filter-hidden",!l),l&&s++),i.add(o)}),s}doesProductMatch(e,t){const i=t.split(/\s+/).filter(e=>e.length>0);for(const t of i){let i=!1;for(const s of this.config.searchableAttributes){const o=e.getAttribute(s);if(o&&o.toLowerCase().includes(t)){i=!0;break}}if(!i)return!1}return i.length>0}clearExistingFilters(){}clearFiltersOnly(){window.filterControls&&window.filterControls.resetFiltersOnly&&(window.filterControls.resetFiltersOnly(),console.log("ðŸš€ PERFORMANCE: Filters cleared but search preserved"))}showAllItemsCSS(){this.originalProducts.forEach(e=>{const t=e.closest(".w-dyn-item");t&&t.classList.remove("filter-hidden")})}showNoResultsMessage(){if(!this.gridContainer)return;this.clearNoResultsMessage();const e=document.createElement("div");e.style.width="100%",e.style.textAlign="center",e.style.padding="40px 20px",e.style.color="#666",e.style.fontSize="18px",e.innerHTML="No products found matching your search.",e.className="no-results-message",this.gridContainer.appendChild(e)}clearNoResultsMessage(){if(this.gridContainer){const e=this.gridContainer.querySelector(".no-results-message");e&&e.remove()}}clearSearch(){this.clearSearchInput(),this.isSearchActive=!1,this.searchTimeout&&(clearTimeout(this.searchTimeout),this.searchTimeout=null),this.clearNoResultsMessage(),this.showAllItemsCSS(),this.clearExistingFilters(),console.log("ðŸš€ PERFORMANCE: Search cleared - showing all products")}clearSearchInput(){this.searchInput&&(this.searchInput.value="")}clearSearchState(){this.isSearchActive=!1,this.searchTimeout&&(clearTimeout(this.searchTimeout),this.searchTimeout=null),this.clearNoResultsMessage(),this.showAllItemsCSS()}isActive(){return this.isSearchActive}getCurrentSearchTerm(){return this.searchInput?this.searchInput.value.trim():""}setupGlobalAccess(){window.searchManager=window.searchManager||{},window.searchManager.clearSearch=()=>this.clearSearch(),window.searchManager.clearSearchInput=()=>this.clearSearchInput(),window.searchManager.clearSearchState=()=>this.clearSearchState(),window.searchManager.isActive=()=>this.isActive(),window.searchManager.getCurrentTerm=()=>this.getCurrentSearchTerm(),window.searchManager.filterProductsWithCSS=e=>this.filterProductsWithCSS(e),window.searchManager.clearNoResultsMessage=()=>this.clearNoResultsMessage()}}({inputId:"search-product-list",iconId:"svg-icon-search",debounceDelay:300,searchableAttributes:["data-name2","data-mint","data-metal","data-size","data-year","data-product-id","data-type"]})}),document.addEventListener("DOMContentLoaded",function(){"use strict";const e=new class{constructor(e){this.config=e,this.dropdown=null,this.gridContainer=null,this.originalOrder=[],this.activeSortType=null,this.init()}init(){this.findDropdown()}findDropdown(){if(this.dropdown=document.getElementById(this.config.dropdownId),!this.dropdown)return console.log("Waiting for sort dropdown to be ready..."),void setTimeout(()=>this.findDropdown(),this.config.retryDelay);this.captureOriginalOrder(),this.bindEvents(),console.log("ðŸš€ PERFORMANCE OPTIMIZED Sort Manager initialized")}captureOriginalOrder(){if(this.gridContainer=document.querySelector(".w-dyn-items.w-row"),this.gridContainer){this.gridContainer.querySelectorAll(".w-dyn-item").forEach(e=>{const t=e.querySelector(".product-data");t&&this.originalOrder.push(t.getAttribute("data-slug"))}),console.log(`ðŸš€ PERFORMANCE: Found products container with ${this.originalOrder.length} products`)}else console.error("Could not find products container")}bindEvents(){this.dropdown.addEventListener("sortOperation",e=>{const{operation:t,resetFirst:i}=e.detail;this.handleSortSelection(t,i)})}handleSortSelection(e,t){console.log(`ðŸš€ PERFORMANCE: Sort selected: ${e}, resetFirst: ${t}`),t&&this.resetFilters(),"default"===e?this.restoreOriginalOrder():this.config.rules[e]?this.applySortRuleOptimized(e):console.warn(`Unknown sort type: ${e}`)}resetFilters(){window.filterControls&&window.filterControls.resetFiltersOnly&&(window.filterControls.resetFiltersOnly(),console.log("ðŸš€ PERFORMANCE: Filters reset by sort operation (search preserved)"))}applySortRuleOptimized(e){const t=this.config.rules[e];if(window.searchManager&&window.searchManager.clearNoResultsMessage&&window.searchManager.clearNoResultsMessage(),window.searchManager&&window.searchManager.isActive()){const e=window.searchManager.getCurrentTerm();e&&window.searchManager.filterProductsWithCSS(e)}if(!this.gridContainer)return void console.error("Grid container not found");const i=Array.from(this.gridContainer.querySelectorAll(".w-dyn-item:not(.filter-hidden)")),s=[];i.forEach(e=>{const i=e.querySelector(`[${t.attribute}]`);if(!i)return;const o=i.getAttribute(t.attribute),r=this.parseSortValue(o,t);null!==r&&s.push({element:e,value:r,rawValue:o})}),this.sortItems(s,t);const o=document.createDocumentFragment();s.forEach(e=>{o.appendChild(e.element)}),this.gridContainer.appendChild(o),this.activeSortType=e,console.log(`ðŸš€ PERFORMANCE: Sorted ${s.length} items by ${t.name}`)}parseSortValue(e,t){if("number"===t.type){const i=parseFloat(e.replace(/,/g,""));return isNaN(i)?"data-year"===t.attribute?-999:null:i}return e}sortItems(e,t){e.sort((e,i)=>"asc"===t.direction?e.value-i.value:i.value-e.value)}restoreOriginalOrder(){if(window.searchManager&&window.searchManager.clearNoResultsMessage&&window.searchManager.clearNoResultsMessage(),window.searchManager&&window.searchManager.isActive()){const e=window.searchManager.getCurrentTerm();e&&window.searchManager.filterProductsWithCSS(e)}if(this.gridContainer&&this.originalOrder.length>0){const e=document.createDocumentFragment();this.originalOrder.forEach(t=>{const i=this.gridContainer.querySelector(`[data-slug="${t}"]`);if(i){const t=i.closest(".w-dyn-item");t&&e.appendChild(t)}}),this.gridContainer.appendChild(e),console.log(`ðŸš€ PERFORMANCE: Restored ${this.originalOrder.length} items to original order`)}this.activeSortType=null,console.log("ðŸš€ PERFORMANCE: Default order restored")}getCurrentSort(){return this.activeSortType}refreshSort(){this.activeSortType&&this.config.rules[this.activeSortType]&&this.applySortRuleOptimized(this.activeSortType)}sortVisibleItems(e){const t=this.config.rules[e];if(!t||!this.gridContainer)return;const i=Array.from(this.gridContainer.querySelectorAll(".w-dyn-item:not(.filter-hidden)")),s=[];i.forEach(e=>{const i=e.querySelector(`[${t.attribute}]`);if(!i)return;const o=i.getAttribute(t.attribute),r=this.parseSortValue(o,t);null!==r&&s.push({element:e,value:r,rawValue:o})}),this.sortItems(s,t);const o=document.createDocumentFragment();s.forEach(e=>{o.appendChild(e.element)}),this.gridContainer.appendChild(o),console.log(`ðŸš€ PERFORMANCE: Sorted ${s.length} visible items by ${t.name}`)}}({dropdownId:"custom-filter",retryDelay:300,rules:{value:{attribute:"data-value",type:"number",direction:"asc",name:"Value (Best per Oz)"},latest:{attribute:"data-year",type:"number",direction:"desc",name:"Latest/2025 Coins"},"lowest-price":{attribute:"data-price-nzd",type:"number",direction:"asc",name:"Price: Low to High"},"highest-price":{attribute:"data-price-nzd",type:"number",direction:"desc",name:"Price: High to Low"},"lowest-weight":{attribute:"data-weight-grams",type:"number",direction:"asc",name:"Weight: Low to High"},"highest-weight":{attribute:"data-weight-grams",type:"number",direction:"desc",name:"Weight: High to Low"}}});window.sortManager=e}),document.addEventListener("DOMContentLoaded",()=>{const e=new URLSearchParams(window.location.search).get("filter");if(e){const t=e.replace(/[()]/g,""),[i,s]=t.split("=");if(i&&s&&window.FILTER_CONFIG&&window.FILTER_CONFIG.rules){const e=Object.keys(window.FILTER_CONFIG.rules).find(e=>{const t=window.FILTER_CONFIG.rules[e];return t.attribute===i&&t.values&&t.values.includes(s)});if(e){const t=document.getElementById(e);t&&t.click()}}}});