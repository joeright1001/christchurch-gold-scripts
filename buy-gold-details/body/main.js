document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("buy-back-product"),e=document.getElementById("cert-buy-back-heading");t&&e&&(t.style.cursor="pointer",t.addEventListener("click",function(t){t.preventDefault(),e.click();const n=e.getBoundingClientRect().top+window.pageYOffset-100;$("html, body").animate({scrollTop:n},1200,"swing")}));const n=[document.getElementById("brands-we-sell-linkv2"),document.getElementById("brands-we-sell-linkv4")],o=document.getElementById("brands-we-sell");o&&n.forEach(function(t){t&&(t.style.cursor="pointer",t.addEventListener("click",function(t){t.preventDefault(),o.click();const e=o.getBoundingClientRect().top+window.pageYOffset-100;$("html, body").animate({scrollTop:e},1200,"swing")}))});const i=document.getElementById("how-it-works-link"),d=document.getElementById("how-it-works");i&&d&&(i.style.cursor="pointer",i.addEventListener("click",function(t){t.preventDefault(),d.click();const e=d.getBoundingClientRect().top+window.pageYOffset-100;$("html, body").animate({scrollTop:e},1200,"swing")}))}),document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("product-name-full"),e=document.getElementById("quantity"),n=document.getElementById("total-price"),o=document.getElementById("zoho-id"),i=document.getElementById("price_nzd"),d=document.getElementById("image-url"),r=document.getElementById("website-url"),l=document.getElementById("product-name"),a=document.getElementById("metal"),c=document.getElementById("product-type"),s=document.getElementById("broker");function m(e,o=10){t?.textContent.trim()&&n?.textContent.trim()?e():o?setTimeout(()=>m(e,o-1),200):alert("Failed to load product details. Please try again.")}s?.addEventListener("click",function(s){s.preventDefault(),m(()=>{const s=t.textContent.trim(),m=parseInt(e.value,10)||1,u=n.textContent.trim(),p=o?.textContent.trim()||"",g=i?.textContent.trim()||"";if(!(s&&m&&u&&p&&g))return void alert("Please ensure all fields are filled out before placing the order.");const y=new URLSearchParams({"product-name-full":s,quantity:m,"total-price":u,"zoho-id":p,price_nzd:g,"image-url":d?.textContent.trim()||"","website-url":r?.textContent.trim()||"","product-name":l?.textContent.trim()||"",metal:a?.textContent.trim()||"","product-type":c?.textContent.trim()||""});window.location.href=`/contact-us?${y.toString()}`})})}),document.addEventListener("DOMContentLoaded",function(){const t=t=>parseFloat(String(t).replace(/[^0-9.\-]+/g,""))||0,e=document.getElementById("quantity"),n=document.getElementById("unit-price-nzd"),o=document.getElementById("unit-gst"),i=document.getElementById("total-unit-price-nzd"),d=document.getElementById("total-gst");function r(){const r=parseInt(e.value,10)||1;i.textContent=(t(n.textContent)*r).toFixed(2),d.textContent=(t(o.textContent)*r).toFixed(2)}e&&n&&o&&i&&d&&(e.addEventListener("input",r),r())}),document.addEventListener("DOMContentLoaded",function(){function t(){const t=window.innerWidth;return t<480?{fontSize:"1rem",bottomPosition:"45%",paddingTop:"5px",paddingBottom:"5px",paddingLeft:"10px",paddingRight:"10px",borderRadius:"10px"}:t>=480&&t<768?{fontSize:"1.125rem",bottomPosition:"45%",paddingTop:"5px",paddingBottom:"5px",paddingLeft:"10px",paddingRight:"10px",borderRadius:"15px"}:t>=768&&t<992?{fontSize:"1.5rem",bottomPosition:"45%",paddingTop:"8px",paddingBottom:"8px",paddingLeft:"15px",paddingRight:"15px",borderRadius:"25px"}:{fontSize:"2rem",bottomPosition:"40%",paddingTop:"10px",paddingBottom:"10px",paddingLeft:"20px",paddingRight:"20px",borderRadius:"30px"}}function e(){const e=setInterval(function(){const n=document.querySelector(".w-lightbox-container");if(n&&!document.querySelector(".lightbox-custom-text")){clearInterval(e);const o=t(),i=document.createElement("div");i.style.position="absolute",i.style.bottom=o.bottomPosition,i.style.left="0",i.style.right="0",i.style.textAlign="center",i.style.zIndex="9999",i.style.pointerEvents="none";const d=document.createElement("div");d.className="lightbox-custom-text",d.textContent="1 Oz Silver Krugerrand 2025",d.style.display="inline-block",d.style.color="white",d.style.fontFamily='"Times New Roman", Times, serif',d.style.fontSize=o.fontSize,d.style.textShadow="1px 1px 3px rgba(0,0,0,0.7)",d.style.backgroundColor="rgba(0, 0, 0, 0.4)",d.style.paddingTop=o.paddingTop,d.style.paddingBottom=o.paddingBottom,d.style.paddingLeft=o.paddingLeft,d.style.paddingRight=o.paddingRight,d.style.borderRadius=o.borderRadius,d.style.maxWidth="90%",i.appendChild(d),n.appendChild(i)}},100)}document.querySelectorAll(".product-header1_lightbox-link-2").forEach(t=>{t.addEventListener("click",function(){setTimeout(e,300)})}),document.addEventListener("click",function(t){if(t.target.closest(".w-lightbox-control")&&document.querySelector(".w-lightbox-container")){const t=document.querySelector(".lightbox-custom-text");if(t){const e=t.parentElement;e&&e.remove()}setTimeout(e,300)}}),window.addEventListener("resize",function(){const e=document.querySelector(".lightbox-custom-text");if(e){const n=t();e.style.fontSize=n.fontSize,e.style.paddingTop=n.paddingTop,e.style.paddingBottom=n.paddingBottom,e.style.paddingLeft=n.paddingLeft,e.style.paddingRight=n.paddingRight,e.style.borderRadius=n.borderRadius;const o=e.parentElement;o&&(o.style.bottom=n.bottomPosition)}})}),document.addEventListener("DOMContentLoaded",function(){const t=document.createElement("style");t.textContent="\n    .modal-overlay {\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      background: rgba(0, 0, 0, 0.6);\n      backdrop-filter: blur(8px);\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      z-index: 9999;\n      opacity: 0;\n      visibility: hidden;\n      transition: all 0.3s ease;\n    }\n\n    .modal-overlay.active {\n      opacity: 1;\n      visibility: visible;\n    }\n\n    .modal-content {\n      background: #ffffff;\n      border-radius: 16px;\n      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);\n      max-width: 480px;\n      width: 90%;\n      max-height: 90vh;\n      overflow: hidden;\n      transform: translateY(30px) scale(0.95);\n      transition: all 0.3s ease;\n      position: relative;\n    }\n\n    .modal-overlay.active .modal-content {\n      transform: translateY(0) scale(1);\n    }\n\n    .modal-header {\n      padding: 24px 24px 0 24px;\n      display: flex;\n      justify-content: space-between;\n      align-items: flex-start;\n    }\n\n    .modal-icon {\n      width: 48px;\n      height: 48px;\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n      border-radius: 12px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      color: white;\n      margin-bottom: 16px;\n    }\n\n    .modal-close {\n      background: none;\n      border: none;\n      font-size: 24px;\n      color: #6b7280;\n      cursor: pointer;\n      padding: 4px;\n      line-height: 1;\n      transition: color 0.2s ease;\n    }\n\n    .modal-close:hover {\n      color: #374151;\n    }\n\n    .modal-body {\n      padding: 0 24px 24px 24px;\n    }\n\n    .modal-body h2 {\n      font-size: 24px;\n      font-weight: 600;\n      color: #111827;\n      margin: 0 0 12px 0;\n      line-height: 1.3;\n    }\n\n    .modal-body p {\n      font-size: 16px;\n      color: #6b7280;\n      line-height: 1.6;\n      margin: 0 0 24px 0;\n    }\n\n    .modal-actions {\n      display: flex;\n      gap: 12px;\n      flex-wrap: wrap;\n    }\n\n    .btn-primary, .btn-secondary {\n      padding: 12px 20px;\n      border-radius: 8px;\n      font-size: 14px;\n      font-weight: 500;\n      border: none;\n      cursor: pointer;\n      transition: all 0.2s ease;\n      flex: 1;\n      min-width: 120px;\n    }\n\n    .btn-primary {\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n      color: white;\n    }\n\n    .btn-primary:hover {\n      transform: translateY(-1px);\n      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);\n    }\n\n    .btn-secondary {\n      background: #f3f4f6;\n      color: #374151;\n      border: 1px solid #e5e7eb;\n    }\n\n    .btn-secondary:hover {\n      background: #e5e7eb;\n      transform: translateY(-1px);\n    }\n\n    @media (max-width: 640px) {\n      .modal-content {\n        margin: 20px;\n        width: calc(100% - 40px);\n      }\n      \n      .modal-actions {\n        flex-direction: column;\n      }\n      \n      .btn-primary, .btn-secondary {\n        flex: none;\n        width: 100%;\n      }\n    }\n  ",document.head.appendChild(t);document.body.insertAdjacentHTML("beforeend",'\n    <div id="market-closed-modal" class="modal-overlay">\n      <div class="modal-content">\n        <div class="modal-header">\n          <div class="modal-icon">\n            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n              <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z" fill="currentColor"/>\n            </svg>\n          </div>\n          <button class="modal-close" id="modal-close">&times;</button>\n        </div>\n        <div class="modal-body">\n          <h2>Market Currently Closed</h2>\n          <p>The market is closed. You can wait until trading recommences or speak to a broker during business hours for more options.</p>\n          <div class="modal-actions">\n            <button class="btn-secondary" id="wait-btn">Wait for Market Open</button>\n            <button class="btn-primary" id="contact-broker">Bullion Broker</button>\n          </div>\n        </div>\n      </div>\n    </div>\n  ');const e=document.getElementById("button-closed"),n=document.getElementById("market-closed-modal"),o=document.getElementById("modal-close"),i=document.getElementById("wait-btn"),d=document.getElementById("contact-broker");function r(){n.classList.remove("active"),document.body.style.overflow=""}e&&e.addEventListener("click",function(t){t.preventDefault(),n.classList.add("active"),document.body.style.overflow="hidden"}),o.addEventListener("click",r),n.addEventListener("click",function(t){t.target===n&&r()}),document.addEventListener("keydown",function(t){"Escape"===t.key&&n.classList.contains("active")&&r()}),i.addEventListener("click",function(){r(),console.log("User chose to wait for market open")}),d.addEventListener("click",function(){window.location.href="/contact-us"})}),document.addEventListener("DOMContentLoaded",function(){[{trigger:"heading-menu-drop-mob-sub-jew",content:"site-links-sub-mob-jew",icon:"code-icon-58-jew"},{trigger:"heading-menu-drop-mob-sub-price",content:"site-links-sub-mob-price",icon:"code-icon-58-price"},{trigger:"heading-menu-drop-mob-sub-help",content:"site-links-sub-mob-help",icon:"code-icon-58-help"},{trigger:"heading-menu-drop-mob-sub-bul",content:"site-links-sub-mob-bul",icon:"code-icon-58-bul"},{trigger:"heading-menu-drop-mob-sub-jew2",content:"site-links-sub-mob-jew2",icon:"code-icon-58-jew2"}].forEach(function(t){!function(t,e,n){if(!t||!e||!n)return void console.warn("Missing element for dropdown",t,e,n);e.style.height="0px",e.style.opacity="0",e.style.overflow="hidden",e.style.transition="height 0.3s ease, opacity 0.3s ease",n.style.transition="transform 0.3s ease";let o=!1;function i(t){if(t.preventDefault(),o)e.style.height="0px",e.style.opacity="0",n.style.transform="rotateX(0deg)",o=!1;else{e.style.height="auto";const t=e.offsetHeight+"px";e.style.height="0px",setTimeout(function(){e.style.height=t,e.style.opacity="1",n.style.transform="rotateX(180deg)"},10),o=!0}}t.addEventListener("click",i)}(document.getElementById(t.trigger),document.getElementById(t.content),document.getElementById(t.icon))})}),document.addEventListener("DOMContentLoaded",function(){const t=t=>document.getElementById(t),e=t("product-name-full"),n=t("quantity"),o=t("total-price"),i=t("zoho-id"),d=t("price_nzd"),r=t("unit-gst"),l=t("total-gst"),a=t("unit-price-nzd"),c=t("total-unit-price-nzd"),s=t("image-url"),m=t("website-url"),u=t("product-name"),p=t("metal"),g=t("product-type"),y=t("shippingfee"),x=t("market-status"),f=t("market"),b=t("sku"),h=t("auto-supplier"),k=t("supplier-item-id"),C=t("collect");function E(t,n=10){e.textContent.trim()&&o.textContent.trim()&&C.textContent.trim()?t():n?setTimeout(()=>E(t,n-1),200):alert("Failed to load product details. Please try again.")}t("place-order").addEventListener("click",function(t){t.preventDefault(),E(()=>{const t=new URLSearchParams({"product-name-full":e.textContent.trim(),quantity:parseInt(n.value,10)||1,"total-price":o.textContent.trim(),"zoho-id":i?.textContent.trim()||"","price-nzd":d?.textContent.trim()||"","unit-gst":r?.textContent.trim()||"","total-gst":l?.textContent.trim()||"","unit-price-nzd":a?.textContent.trim()||"","total-unit-price-nzd":c?.textContent.trim()||"","image-url":s?.textContent.trim()||"","website-url":m?.textContent.trim()||"","product-name":u?.textContent.trim()||"",metal:p?.textContent.trim()||"","product-type":g?.textContent.trim()||"",shippingfee:y?.textContent.trim()||"","market-status":x?.textContent.trim()||"",market:f?.textContent.trim()||"",sku:b?.textContent.trim()||"","auto-supplier":h?.textContent.trim()||"","supplier-item-id":k?.textContent.trim()||"",collect:C?.textContent.trim()||""});window.location.href=`/place-order?${t.toString()}`})})}),function(){const t=document.createElement("style");t.textContent="\n    #icon-in-stock,#icon-34-weeks,#icon-35-days,#icon-out-stock,\n    #icon-market-closed,#icon-247,\n    #state-today,#state-34-weeks,#state-35-days,#state-out-stock,\n    #state-market-247,#state-market-nz-open,#state-market-nz-closed,\n    #state-market-dg-open,#state-market-dg-closed,#state-market-out-stock,\n    #place-order,#get-quote,#button-closed,#button-247,\n    #market-button-text-nz-closed,#market-button-text-dg-closed,\n    #market-button-text-closed,#investor-1-oz-gold,#investor-1-oz-silver,\n    #offline-order-text,#broker-text{display:none;}\n  ",document.head.appendChild(t)}(),document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("product-type")?.textContent.trim().toLowerCase()||"",e=document.getElementById("online-order")?.textContent.trim().toLowerCase()||"";function n(t,e="block"){const n=document.getElementById(t);n&&(n.style.display=e)}function o(t){"gold"===t?n("investor-1-oz-gold","inline-block"):"silver"===t?n("investor-1-oz-silver","inline-block"):"all"===t&&(n("investor-1-oz-gold","inline-block"),n("investor-1-oz-silver","inline-block"))}if(["supplier","collectable"].includes(t)){const t=document.getElementById("how-investor-works");t&&(t.style.display="none")}{const t=document.getElementById("gst-incl-block");t&&(t.style.display="none");const e=document.getElementById("unit-gst");if(e&&t){const n=parseFloat(e.value??e.textContent);!isNaN(n)&&n>1&&(t.style.display="flex")}}if(window.location.pathname.startsWith("/buy-gold-details/")){const t=document.getElementById("stock-status")?.textContent.trim(),e=document.getElementById("market-status")?.textContent.trim(),i=document.getElementById("online-order")?.textContent.trim().toLowerCase(),d=document.getElementById("metal")?.textContent.trim().toLowerCase();if("false"===i)return n("broker"),n("offline-order-text"),n("state-out-stock","flex"),void n("icon-out-stock");t&&e&&("dg-closed"===e&&"live-at-the-mint"===t?(n("state-market-dg-closed","block"),o(d),n("icon-market-closed"),n("button-closed"),n("broker-text"),n("broker"),n("market-button-text-dg-closed")):"dg-open"===e&&"live-at-the-mint"===t?(n("place-order","inline-block"),n("get-quote","inline-block"),n("broker-text"),n("broker"),n("icon-34-weeks"),n("state-market-dg-open","flex"),n("state-34-weeks","flex")):"dg-closed"===e&&"out-stock"===t||"dg-open"===e&&"out-stock"===t?(n("broker"),n("offline-order-text"),n("state-market-out-stock","block"),o(d),n("icon-out-stock")):"247-open"===e&&"in-stock"===t?(n("place-order","inline-block"),n("get-quote","inline-block"),n("broker-text"),n("broker"),n("state-today","flex"),n("state-market-247","flex"),n("icon-in-stock"),n("icon-247")):"247-open"===e&&"low-stock"===t&&(n("place-order","inline-block"),n("get-quote","inline-block"),n("broker-text"),n("broker"),n("state-35-days","flex"),n("icon-35-days")))}"collectable"===t&&"true"===e&&n("button-247","inline-block")});const COUNTDOWN_SECONDS=300,FIELDS_TO_UPDATE=["#price_nzd","#unit-price-nzd","#unit-gst"],minCounterEl=document.getElementById("min-counter"),secCounterEl=document.getElementById("sec-counter"),text=t=>t?t.textContent.trim():null;function fetchAndUpdatePrices(){const t=new XMLHttpRequest;t.open("GET",window.location.href,!0),t.onreadystatechange=()=>{if(4!==t.readyState||200!==t.status)return;const e=document.createElement("html");e.innerHTML=t.responseText;const n={};FIELDS_TO_UPDATE.forEach(t=>{const o=e.querySelector(t),i=document.querySelector(t);if(!o||!i)return;const d=text(o);d!==text(i)&&(i.textContent=d,n[t]=d)}),Object.keys(n).length&&document.dispatchEvent(new CustomEvent("price-refreshed",{detail:n}))},t.send()}function startCountdown(){if(!minCounterEl||!secCounterEl)return void setInterval(fetchAndUpdatePrices,3e5);let t=300;function e(){const e=Math.floor(t/60),n=t%60;minCounterEl.textContent=String(e).padStart(2,"0"),secCounterEl.textContent=String(n).padStart(2,"0"),--t<0&&(fetchAndUpdatePrices(),t=300)}e(),setInterval(e,1e3)}document.addEventListener("DOMContentLoaded",()=>{fetchAndUpdatePrices(),startCountdown()}),function(){const t=document.getElementById("quantity"),e=document.getElementById("min-quantity-value"),n=document.getElementById("max-quantity-value"),o=document.getElementById("price_nzd"),i=document.getElementById("total-price"),d=document.getElementById("unit-price-nzd"),r=document.getElementById("unit-gst"),l=document.getElementById("total-unit-price-nzd"),a=document.getElementById("total-gst"),c=t=>parseFloat(String(t).replace(/[^0-9.\-]+/g,""))||0;function s(){const e=parseInt(t?.value,10)||1;o&&i&&(i.textContent=(c(o.textContent)*e).toFixed(2)),d&&l&&(l.textContent=(c(d.textContent)*e).toFixed(2)),r&&a&&(a.textContent=(c(r.textContent)*e).toFixed(2))}function m(e,n){const o=document.createElement("span");return o.className=n,o.textContent=e,o.style.display="none",t.parentNode.insertBefore(o,t.nextSibling),o}let u=null,p=null,g=!1;function y(){if(!t)return;let o=1;if(e){const t=parseInt(e.textContent.trim(),10);isNaN(t)||(o=t)}let i=1/0;if(n){const t=parseInt(n.textContent.trim(),10);isNaN(t)||(i=t)}let d=parseInt(t.value,10)||o;d<o&&(d=o),d>i&&(d=i),t.value=d,g&&(u&&(u.style.display=d<=o?"inline-block":"none"),p&&(p.style.display=d>=i?"inline-block":"none")),s()}document.addEventListener("DOMContentLoaded",()=>{if(!t)return;if(!document.getElementById("qty-limits-style")){const t=document.createElement("style");t.id="qty-limits-style",t.textContent="\n        .min-qty-message,\n        .max-qty-message {\n          margin-left: 5px;\n          font-size: 0.875rem;\n          line-height: 1;\n          vertical-align: middle;\n          color: #c00; /* red */\n        }\n      ",document.head.appendChild(t)}t.style.display="inline-block";let o=1;if(e){const t=parseInt(e.textContent.trim(),10);isNaN(t)||(o=t)}if((!t.value||parseInt(t.value,10)<o)&&(t.value=o),e){const n=parseInt(e.textContent.trim(),10);isNaN(n)||(t.setAttribute("min",n),u=m(`min: ${n}`,"min-qty-message"))}if(n){const e=parseInt(n.textContent.trim(),10);isNaN(e)||(t.setAttribute("max",e),p=m(`max: ${e}`,"max-qty-message"))}const i=()=>{g=!0,y()};t.addEventListener("keydown",t=>{"Enter"===t.key&&t.preventDefault(),"ArrowUp"!==t.key&&"ArrowDown"!==t.key||i()}),t.addEventListener("focus",i),t.addEventListener("click",i),t.addEventListener("wheel",i),t.addEventListener("input",i),t.addEventListener("change",i),document.addEventListener("price-refreshed",s),y()})}(),document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("product-name-full"),e=document.getElementById("quantity"),n=document.getElementById("total-price"),o=document.getElementById("zoho-id"),i=document.getElementById("price_nzd"),d=document.getElementById("image-url"),r=document.getElementById("website-url"),l=document.getElementById("product-name"),a=document.getElementById("metal"),c=document.getElementById("shippingfee"),s=document.getElementById("market-status"),m=document.getElementById("market"),u=document.getElementById("sku"),p=document.getElementById("auto-supplier"),g=document.getElementById("supplier-item-id");document.getElementById("get-quote").addEventListener("click",function(y){y.preventDefault(),function(e){let o=0;!function i(){t&&t.textContent.trim()&&n&&n.textContent.trim()?e():o<10?(o++,setTimeout(i,200)):(console.error("CMS data not loaded in time."),alert("Failed to load product details. Please try again."))}()}(()=>{const y=t.textContent.trim(),x=parseInt(e.value,10)||1,f=n.textContent.trim(),b=o?o.textContent.trim():"",h=i?i.textContent.trim():"",k=d?d.textContent.trim():"",C=r?r.textContent.trim():"",E=l?l.textContent.trim():"",v=a?a.textContent.trim():"",w=c?c.textContent.trim():"",I=s?s.textContent.trim():"",B=m?m.textContent.trim():"",L=u?u.textContent.trim():"",z=p?p.textContent.trim():"",R=g?g.textContent.trim():"";if(!(y&&x&&f&&b&&h))return void alert("Please ensure all fields are filled out before placing the order.");const S=`/quote?product-name-full=${encodeURIComponent(y)}&quantity=${encodeURIComponent(x)}&total-price=${encodeURIComponent(f)}&zoho-id=${encodeURIComponent(b)}&price-nzd=${encodeURIComponent(h)}\n      &image-url=${encodeURIComponent(k)}&website-url=${encodeURIComponent(C)}\n      &product-name=${encodeURIComponent(E)}&metal=${encodeURIComponent(v)}\n      &shippingfee=${encodeURIComponent(w)}&market-status=${encodeURIComponent(I)}\n      &market=${encodeURIComponent(B)}&sku=${encodeURIComponent(L)}\n      &auto-supplier=${encodeURIComponent(z)}&supplier-item-id=${encodeURIComponent(R)}`;window.location.href=S})})});