document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("buy-back-product"),e=document.getElementById("cert-buy-back-heading");t&&e&&(t.style.cursor="pointer",t.addEventListener("click",function(t){t.preventDefault(),e.click();const n=e.getBoundingClientRect().top+window.pageYOffset-100;$("html, body").animate({scrollTop:n},1200,"swing")}));const n=[document.getElementById("brands-we-sell-linkv2"),document.getElementById("brands-we-sell-linkv4")],o=document.getElementById("brands-we-sell");o&&n.forEach(function(t){t&&(t.style.cursor="pointer",t.addEventListener("click",function(t){t.preventDefault(),o.click();const e=o.getBoundingClientRect().top+window.pageYOffset-100;$("html, body").animate({scrollTop:e},1200,"swing")}))});const i=document.getElementById("how-it-works-link"),d=document.getElementById("how-it-works");i&&d&&(i.style.cursor="pointer",i.addEventListener("click",function(t){t.preventDefault(),d.click();const e=d.getBoundingClientRect().top+window.pageYOffset-100;$("html, body").animate({scrollTop:e},1200,"swing")}))}),document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("product-name-full"),e=document.getElementById("quantity"),n=document.getElementById("total-price"),o=document.getElementById("zoho-id"),i=document.getElementById("price_nzd"),d=document.getElementById("image-url"),r=document.getElementById("website-url"),a=document.getElementById("product-name"),s=document.getElementById("metal"),l=document.getElementById("product-type"),c=document.getElementById("broker");function u(e,o=10){t?.textContent.trim()&&n?.textContent.trim()?e():o?setTimeout(()=>u(e,o-1),200):alert("Failed to load product details. Please try again.")}c?.addEventListener("click",function(c){c.preventDefault(),u(()=>{const c=t.textContent.trim(),u=parseInt(e.value,10)||1,m=n.textContent.trim(),p=o?.textContent.trim()||"",g=i?.textContent.trim()||"",y=new URLSearchParams({"product-name-full":c,quantity:u,"total-price":m,"zoho-id":p,price_nzd:g,"image-url":d?.textContent.trim()||"","website-url":r?.textContent.trim()||"","product-name":a?.textContent.trim()||"",metal:s?.textContent.trim()||"","product-type":l?.textContent.trim()||""});window.location.href=`/connect-dealer?${y.toString()}`})})}),document.addEventListener("DOMContentLoaded",function(){const t=t=>parseFloat(String(t).replace(/[^0-9.\-]+/g,""))||0,e=document.getElementById("quantity"),n=document.getElementById("unit-price-nzd"),o=document.getElementById("unit-gst"),i=document.getElementById("unit-total-price-nzd"),d=document.getElementById("unit-total-gst"),r=document.getElementById("gst-total"),a=document.getElementById("sub-total");function s(){const s=parseInt(e.value,10)||1,l=t(n.textContent)*s,c=t(o.textContent)*s;i.textContent=l.toFixed(2),a.textContent=l.toFixed(2),d.textContent=c.toFixed(2),r.textContent=c.toFixed(2)}e&&n&&o&&i&&d&&r&&a&&(e.addEventListener("input",s),s())}),document.addEventListener("DOMContentLoaded",function(){function t(){const t=window.innerWidth;return t<480?{fontSize:"1rem",bottomPosition:"20%",paddingTop:"5px",paddingBottom:"5px",paddingLeft:"10px",paddingRight:"10px",borderRadius:"10px"}:t>=480&&t<768?{fontSize:"1.125rem",bottomPosition:"20%",paddingTop:"5px",paddingBottom:"5px",paddingLeft:"10px",paddingRight:"10px",borderRadius:"15px"}:t>=768&&t<992?{fontSize:"1.5rem",bottomPosition:"20%",paddingTop:"8px",paddingBottom:"8px",paddingLeft:"15px",paddingRight:"15px",borderRadius:"25px"}:{fontSize:"2rem",bottomPosition:"20%",paddingTop:"10px",paddingBottom:"10px",paddingLeft:"20px",paddingRight:"20px",borderRadius:"30px"}}function e(){const e=setInterval(function(){const n=document.querySelector(".w-lightbox-container");if(n&&!document.querySelector(".lightbox-custom-text")){clearInterval(e);const o=t(),i=document.createElement("div");i.style.position="absolute",i.style.bottom=o.bottomPosition,i.style.left="0",i.style.right="0",i.style.textAlign="center",i.style.zIndex="9999",i.style.pointerEvents="none";const d=document.getElementById("product-name"),r=d?d.textContent:"Product Name",a=document.createElement("div");a.className="lightbox-custom-text",a.textContent=r,a.style.display="inline-block",a.style.color="white",a.style.fontFamily='"Times New Roman", Times, serif',a.style.fontSize=o.fontSize,a.style.textShadow="1px 1px 3px rgba(0,0,0,0.7)",a.style.backgroundColor="rgba(0, 0, 0, 0.4)",a.style.paddingTop=o.paddingTop,a.style.paddingBottom=o.paddingBottom,a.style.paddingLeft=o.paddingLeft,a.style.paddingRight=o.paddingRight,a.style.borderRadius=o.borderRadius,a.style.maxWidth="90%",i.appendChild(a),n.appendChild(i)}},100)}document.querySelectorAll(".product-header1_lightbox-link-2").forEach(t=>{t.addEventListener("click",function(){setTimeout(e,300)})}),document.addEventListener("click",function(t){if(t.target.closest(".w-lightbox-control")&&document.querySelector(".w-lightbox-container")){const t=document.querySelector(".lightbox-custom-text");if(t){const e=t.parentElement;e&&e.remove()}setTimeout(e,300)}}),window.addEventListener("resize",function(){const e=document.querySelector(".lightbox-custom-text");if(e){const n=t();e.style.fontSize=n.fontSize,e.style.paddingTop=n.paddingTop,e.style.paddingBottom=n.paddingBottom,e.style.paddingLeft=n.paddingLeft,e.style.paddingRight=n.paddingRight,e.style.borderRadius=n.borderRadius;const o=e.parentElement;o&&(o.style.bottom=n.bottomPosition)}})}),document.addEventListener("DOMContentLoaded",function(){const t=document.createElement("style");t.textContent="\n    .modal-overlay {\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      background: rgba(0, 0, 0, 0.6);\n      backdrop-filter: blur(8px);\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      z-index: 9999;\n      opacity: 0;\n      visibility: hidden;\n      transition: all 0.3s ease;\n    }\n\n    .modal-overlay.active {\n      opacity: 1;\n      visibility: visible;\n    }\n\n    .modal-content {\n      background: #ffffff;\n      border-radius: 16px;\n      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);\n      max-width: 480px;\n      width: 90%;\n      max-height: 90vh;\n      overflow: hidden;\n      transform: translateY(30px) scale(0.95);\n      transition: all 0.3s ease;\n      position: relative;\n    }\n\n    .modal-overlay.active .modal-content {\n      transform: translateY(0) scale(1);\n    }\n\n    .modal-header {\n      padding: 24px 24px 0 24px;\n      display: flex;\n      justify-content: space-between;\n      align-items: flex-start;\n    }\n\n    .modal-icon {\n      width: 48px;\n      height: 48px;\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n      border-radius: 12px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      color: white;\n      margin-bottom: 16px;\n    }\n\n    .modal-close {\n      background: none;\n      border: none;\n      font-size: 24px;\n      color: #6b7280;\n      cursor: pointer;\n      padding: 4px;\n      line-height: 1;\n      transition: color 0.2s ease;\n    }\n\n    .modal-close:hover {\n      color: #374151;\n    }\n\n    .modal-body {\n      padding: 0 24px 24px 24px;\n    }\n\n    .modal-body h2 {\n      font-size: 24px;\n      font-weight: 600;\n      color: #111827;\n      margin: 0 0 12px 0;\n      line-height: 1.3;\n    }\n\n    .modal-body p {\n      font-size: 16px;\n      color: #6b7280;\n      line-height: 1.6;\n      margin: 0 0 24px 0;\n    }\n\n    .modal-actions {\n      display: flex;\n      gap: 12px;\n      flex-wrap: wrap;\n    }\n\n    .btn-primary, .btn-secondary {\n      padding: 12px 20px;\n      border-radius: 8px;\n      font-size: 14px;\n      font-weight: 500;\n      border: none;\n      cursor: pointer;\n      transition: all 0.2s ease;\n      flex: 1;\n      min-width: 120px;\n    }\n\n    .btn-primary {\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n      color: white;\n    }\n\n    .btn-primary:hover {\n      transform: translateY(-1px);\n      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);\n    }\n\n    .btn-secondary {\n      background: #f3f4f6;\n      color: #374151;\n      border: 1px solid #e5e7eb;\n    }\n\n    .btn-secondary:hover {\n      background: #e5e7eb;\n      transform: translateY(-1px);\n    }\n\n    @media (max-width: 640px) {\n      .modal-content {\n        margin: 20px;\n        width: calc(100% - 40px);\n      }\n      \n      .modal-actions {\n        flex-direction: column;\n      }\n      \n      .btn-primary, .btn-secondary {\n        flex: none;\n        width: 100%;\n      }\n    }\n  ",document.head.appendChild(t);document.body.insertAdjacentHTML("beforeend",'\n    <div id="market-closed-modal" class="modal-overlay">\n      <div class="modal-content">\n        <div class="modal-header">\n          <div class="modal-icon">\n            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n              <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z" fill="currentColor"/>\n            </svg>\n          </div>\n          <button class="modal-close" id="modal-close">&times;</button>\n        </div>\n        <div class="modal-body">\n          <h2>Market Currently Closed</h2>\n          <p>The market is closed. You can wait until trading recommences or speak to a broker during business hours for more options.</p>\n          <div class="modal-actions">\n            <button class="btn-secondary" id="wait-btn">Wait for Market Open</button>\n            <button class="btn-primary" id="contact-broker">Bullion Broker</button>\n          </div>\n        </div>\n      </div>\n    </div>\n  ');const e=document.getElementById("button-closed"),n=document.getElementById("market-closed-modal"),o=document.getElementById("modal-close"),i=document.getElementById("wait-btn"),d=document.getElementById("contact-broker");function r(){n.classList.remove("active"),document.body.style.overflow=""}e&&e.addEventListener("click",function(t){t.preventDefault(),n.classList.add("active"),document.body.style.overflow="hidden"}),o.addEventListener("click",r),n.addEventListener("click",function(t){t.target===n&&r()}),document.addEventListener("keydown",function(t){"Escape"===t.key&&n.classList.contains("active")&&r()}),i.addEventListener("click",function(){r(),console.log("User chose to wait for market open")}),d.addEventListener("click",function(){window.location.href="/contact-us"})}),document.addEventListener("DOMContentLoaded",function(){[{trigger:"heading-menu-drop-mob-sub-jew",content:"site-links-sub-mob-jew",icon:"code-icon-58-jew"},{trigger:"heading-menu-drop-mob-sub-price",content:"site-links-sub-mob-price",icon:"code-icon-58-price"},{trigger:"heading-menu-drop-mob-sub-help",content:"site-links-sub-mob-help",icon:"code-icon-58-help"},{trigger:"heading-menu-drop-mob-sub-bul",content:"site-links-sub-mob-bul",icon:"code-icon-58-bul"},{trigger:"heading-menu-drop-mob-sub-jew2",content:"site-links-sub-mob-jew2",icon:"code-icon-58-jew2"}].forEach(function(t){!function(t,e,n){if(!t||!e||!n)return void console.warn("Missing element for dropdown",t,e,n);e.style.height="0px",e.style.opacity="0",e.style.overflow="hidden",e.style.transition="height 0.3s ease, opacity 0.3s ease",n.style.transition="transform 0.3s ease";let o=!1;function i(t){if(t.preventDefault(),o)e.style.height="0px",e.style.opacity="0",n.style.transform="rotateX(0deg)",o=!1;else{e.style.height="auto";const t=e.offsetHeight+"px";e.style.height="0px",setTimeout(function(){e.style.height=t,e.style.opacity="1",n.style.transform="rotateX(180deg)"},10),o=!0}}t.addEventListener("click",i)}(document.getElementById(t.trigger),document.getElementById(t.content),document.getElementById(t.icon))})}),document.addEventListener("DOMContentLoaded",function(){const t=t=>document.getElementById(t),e=t("slug"),n=t("place-order"),o=t("product-name-full"),i=t("total-price"),d=["quantity","unit-price-nzd","unit-total-price-nzd","unit-gst","unit-total-gst","gst-total","sub-total","total-price","price_nzd","price-signed","product-name-full"];function r(t,n=10){const d=e?.textContent.trim(),a=o?.textContent.trim(),s=i?.textContent.trim();d&&a&&s?t():n>0?setTimeout(()=>r(t,n-1),200):alert("Failed to load product details. Please refresh and try again.")}n.addEventListener("click",function(n){n.preventDefault(),r(()=>{const n=e.textContent.trim();if(!n)return void alert("Product slug is missing. Cannot proceed.");const o=new URLSearchParams;o.set("slug",n),d.forEach(e=>{const n=t(e);let i="";n&&(i="value"in n?n.value:n.textContent),o.set(e,i.trim())});const i=`/place-order?${o.toString()}`;window.location.href=i})})});const COUNTDOWN_SECONDS=300,FIELDS_TO_UPDATE=["#price_nzd","#unit-price-nzd","#unit-gst"],minCounterEl=document.getElementById("min-counter"),secCounterEl=document.getElementById("sec-counter"),text=t=>t?t.textContent.trim():null;function fetchAndUpdatePrices(){const t=new XMLHttpRequest;t.open("GET",window.location.href,!0),t.onreadystatechange=()=>{if(4!==t.readyState||200!==t.status)return;const e=document.createElement("html");e.innerHTML=t.responseText;const n={};FIELDS_TO_UPDATE.forEach(t=>{const o=e.querySelector(t),i=document.querySelector(t);if(!o||!i)return;const d=text(o);d!==text(i)&&(i.textContent=d,n[t]=d)}),Object.keys(n).length&&document.dispatchEvent(new CustomEvent("price-refreshed",{detail:n}))},t.send()}function startCountdown(){if(!minCounterEl||!secCounterEl)return void setInterval(fetchAndUpdatePrices,3e5);let t=300;function e(){const e=Math.floor(t/60),n=t%60;minCounterEl.textContent=String(e).padStart(2,"0"),secCounterEl.textContent=String(n).padStart(2,"0"),--t<0&&(fetchAndUpdatePrices(),t=300)}e(),setInterval(e,1e3)}function initUserReviews(){console.log("User reviews script started.");const t=document.querySelectorAll(".user-review-block");console.log(`Found ${t.length} review blocks.`),t.forEach((t,e)=>{const n=t.querySelector(".hidden-user-review-data");if(n){const e=parseInt(n.getAttribute("data-stars"),10),o=t.querySelector(".stars-wrapper");if(o)for(let t=1;t<=5;t++){const n=o.querySelector("#star"+t);n&&(n.style.display=t<=e?"block":"none")}}else console.log(`Hidden data not found for review block ${e}.`)});const e=document.querySelector(".hidden-user-review-data");if(e){const t=parseFloat(e.getAttribute("data-average")),n=e.getAttribute("data-total-no-reviews"),o=document.getElementById("stars-average"),i=document.getElementById("total-no-reviews");o&&(o.textContent=t.toFixed(1)),i&&(i.textContent=n);const d=Math.floor(t),r=t%1>=.5;for(let t=1;t<=5;t++){const e=document.getElementById("star-ave"+t);e&&(e.style.display="none")}for(let t=1;t<=d;t++){const e=document.getElementById("star-ave"+t);e&&(e.style.display="block")}const a=document.getElementById("star-ave1-2");a&&(a.style.display=r?"block":"none")}else console.log("First hidden data for average rating not found.")}document.addEventListener("DOMContentLoaded",()=>{fetchAndUpdatePrices(),startCountdown()}),function(){const t=document.getElementById("quantity"),e=document.getElementById("min-quantity-value"),n=document.getElementById("max-quantity-value"),o=document.getElementById("price_nzd"),i=document.getElementById("total-price"),d=document.getElementById("unit-price-nzd"),r=document.getElementById("unit-gst"),a=document.getElementById("total-unit-price-nzd"),s=document.getElementById("total-gst"),l=t=>parseFloat(String(t).replace(/[^0-9.\-]+/g,""))||0;function c(){const e=parseInt(t?.value,10)||1;o&&i&&(i.textContent=(l(o.textContent)*e).toFixed(2)),d&&a&&(a.textContent=(l(d.textContent)*e).toFixed(2)),r&&s&&(s.textContent=(l(r.textContent)*e).toFixed(2))}function u(e,n){const o=document.createElement("span");return o.className=n,o.textContent=e,o.style.display="none",t.parentNode.insertBefore(o,t.nextSibling),o}let m=null,p=null,g=!1;function y(){if(!t)return;let o=1;if(e){const t=parseInt(e.textContent.trim(),10);isNaN(t)||(o=t)}let i=1/0;if(n){const t=parseInt(n.textContent.trim(),10);isNaN(t)||(i=t)}let d=parseInt(t.value,10)||o;d<o&&(d=o),d>i&&(d=i),t.value=d,g&&(m&&(m.style.display=d<=o?"inline-block":"none"),p&&(p.style.display=d>=i?"inline-block":"none")),c()}document.addEventListener("DOMContentLoaded",()=>{if(!t)return;if(!document.getElementById("qty-limits-style")){const t=document.createElement("style");t.id="qty-limits-style",t.textContent="\n        .min-qty-message,\n        .max-qty-message {\n          margin-left: 5px;\n          font-size: 0.875rem;\n          line-height: 1;\n          vertical-align: middle;\n          color: #c00; /* red */\n        }\n      ",document.head.appendChild(t)}t.style.display="inline-block";let o=1;if(e){const t=parseInt(e.textContent.trim(),10);isNaN(t)||(o=t)}if((!t.value||parseInt(t.value,10)<o)&&(t.value=o),e){const n=parseInt(e.textContent.trim(),10);isNaN(n)||(t.setAttribute("min",n),m=u(`min: ${n}`,"min-qty-message"))}if(n){const e=parseInt(n.textContent.trim(),10);isNaN(e)||(t.setAttribute("max",e),p=u(`max: ${e}`,"max-qty-message"))}const i=()=>{g=!0,y()};t.addEventListener("keydown",t=>{"Enter"===t.key&&t.preventDefault(),"ArrowUp"!==t.key&&"ArrowDown"!==t.key||i()}),t.addEventListener("focus",i),t.addEventListener("click",i),t.addEventListener("wheel",i),t.addEventListener("input",i),t.addEventListener("change",i),document.addEventListener("price-refreshed",c),y()})}(),document.addEventListener("DOMContentLoaded",function(){const t=t=>document.getElementById(t),e=t("product-name-full"),n=t("quantity"),o=t("total-price"),i=t("zoho-id"),d=t("collect"),r=t("price_nzd"),a=t("unit-gst"),s=t("total-gst"),l=t("unit-price-nzd"),c=t("total-unit-price-nzd"),u=t("image-url"),m=t("website-url"),p=t("product-name"),g=t("metal"),y=t("product-type"),f=t("shippingfee"),x=t("market-status"),b=t("market"),h=t("sku"),v=t("auto-supplier"),E=t("supplier-item-id");function w(t,n=10){e.textContent.trim()&&o.textContent.trim()?t():n?setTimeout(()=>w(t,n-1),200):alert("Failed to load product details. Please try again.")}t("get-quote").addEventListener("click",function(t){t.preventDefault(),w(()=>{const t=new URLSearchParams({"product-name-full":e.textContent.trim(),quantity:parseInt(n.value,10)||1,"total-price":o.textContent.trim(),"zoho-id":i?.textContent.trim()||"",collect:d?.textContent.trim()||"","price-nzd":r?.textContent.trim()||"","unit-gst":a?.textContent.trim()||"","total-gst":s?.textContent.trim()||"","unit-price-nzd":l?.textContent.trim()||"","total-unit-price-nzd":c?.textContent.trim()||"","image-url":u?.textContent.trim()||"","website-url":m?.textContent.trim()||"","product-name":p?.textContent.trim()||"",metal:g?.textContent.trim()||"","product-type":y?.textContent.trim()||"",shippingfee:f?.textContent.trim()||"","market-status":x?.textContent.trim()||"",market:b?.textContent.trim()||"",sku:h?.textContent.trim()||"","auto-supplier":v?.textContent.trim()||"","supplier-item-id":E?.textContent.trim()||""});window.location.href=`/quote?${t.toString()}`})})}),document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("user-reviews-link"),e=document.getElementById("user-review-heading");t&&e&&(t.style.cursor="pointer",t.addEventListener("click",function(t){t.preventDefault(),e.click();const n=e.getBoundingClientRect().top+window.pageYOffset-100;$("html, body").animate({scrollTop:n},1200,"swing")}))});const observer=new MutationObserver((t,e)=>{const n=document.getElementById("user-reviews");n&&n.querySelector(".user-review-block")&&(initUserReviews(),e.disconnect())});observer.observe(document.body,{childList:!0,subtree:!0}),document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("user-reviews");t&&t.querySelector(".user-review-block")&&initUserReviews()});